## Что такое Ansible?

Ansible — это программное решение для удаленного управления конфигурациями. Оно позволяет настраивать удаленные машины. Главное его отличие от других подобных систем в том, что Ansible использует существующую инфраструктуру SSH, в то время как другие (chef, puppet, и пр.) требуют установки специального PKI-окружения.

Оно написано на языке программирования python и языке разметки YAML для описания разметки.

Поддерживается управление как Linux узлами, так и Windows, но все же чаще первое.

В 2015 году вошла в Red Hat Inc. Входит в большинство дистрибутивов для Linux.

***Интересный факт***: Словом «**Ansible**» названа вымышленная система мгновенной гиперпространственной связи. Эта система была в мире ***Игра Эндера*** Орсона С. Карда, само слово придумано **Урсулой Ле Гуин** в романе **Мир Роканнона** (1966).



## Ключевые особенности

- **Безагентное**. В клиенте не установлено программное обеспечение или агент, который общается с сервером.
- **Идемпотентное**. Независимо от того, сколько раз вы вызываете операцию, результат будет одинаковым.
- **Простое и расширяемое**. Программа Ansible написанa на Python и использует YAML для написания команд. Оба языка считаются относительно простыми в изучении.

Изображение: [Применяем Ansible (slideshare.net)](https://www.slideshare.net/alexsvetkin/ansible-79835964)

Документация: [Ansible Documentation](https://docs.ansible.com/)

​	

## Инициализация

На контролирующей машине инженера (контроллере): можно посмотреть подробную [документацию](https://docs.ansible.com/ansible/devel/installation_guide/intro_installation.html#installing-ansible-on-windows). Для установки необходимы: командная строка и текстовый редактор.

На серверах: установка Ansible не требуется. Необходимы: python 2.7 или выше, доступ по SSH с контроллера.

Краткая инструкция: 

1. git clone репозиторий ansible (с ветки devel)
2. установка vagrant и инициализация виртуальной машины на нем
2. добавление ssh-ключей на виртуальной машине
2. настройка файла Inventory (в нем содержатся данные ansible_ssh_host - содержит данные IP-узла, к которому создается соединение; ansible_ssh_user - подключение под указанным аккаунтом.)
2. проверка работоспособности: **ansible** -m ping all -i step-01/hosts
2. Можно начинать работу

[Ссылка на пример](https://habr.com/ru/post/305400/)



## Положительные стороны

1. Взаимодействие с окружениями через SSH. Не нужно ставить клиента(агента) на машину. Для управления узлами, Ansible обрабатывает все коммуникации между мастер – узлами и узлами – агентами по стандартному SSH, или через модуль Paramiko, который является частью Python SSH второй версии.
2. Простота написания сценариев. Плейбуки в Ансибл невероятно просты и читаемы.
3. Декларативный язык
4. Большое количество готовых модулей. Готовые команды "из коробки". Более 100 различных модулей.
5. Большое сообщество. Портал Ansible Galaxy, на котором вы наверняка найдете решение для своей задачи. Это объединение Ansible сообщества, где люди делятся наработками и решениями той или иной задачи. Знаете, это как ответ на мэйл.ру - чтобы вам не пришло реализовать на Ансибл, то как правило, кто – то эту задачу уже решил. Тонны плейбуков, фреймворков, дистрибутивов и сопутствующего ПО.
6. Скорость развертывания новых окружений.
7. Гарантия того, что окружения настроены одинаково.
8. Уменьшение человеческого фактора.



## Недостатки

1. Нет менеджера зависимостей.
2. Неполная документация. Некоторые вопросы  приходится узнавать из сторонних источников или изучать самому.
3. Неудобный debug.
4. Определенное количество ошибок или багов из-за быстрого развития. (как плюс, так и минус)





## Ansible Playbooks

Последовательности команд организуются в playbooks. Позволяет описать процедуру автоматической настройки окружения. Можно использовать на всех окружениях один сценарий. Можно использовать таски в других сценариях.

Для описания используется нотация YAML. Внутри playbook может содержаться не только задачи(tasks), но и шаблон серверов(hosts), к которым применяется playbook, переменные(vars), обработчики(handlers) и др. директивы. Задачи выполняются строго последовательно.



## Структура





### Ссылки:

[Docker, Ansible и прочие радости DevOps_ Дмитрий Абашин презентация, доклад (thepresentation.ru)](https://thepresentation.ru/uncategorized/docker-ansible-i-prochie-radosti-devops_-dmitriy-abashin)

[Ansible — Википедия (wikipedia.org)](https://ru.wikipedia.org/wiki/Ansible)

[Пособие по Ansible / Хабр (habr.com)](https://habr.com/ru/post/305400/)

[ansible-community/molecule: Molecule aids in the development and testing of Ansible roles (github.com)](https://github.com/ansible-community/molecule)

[Что такое Ansible и как его использовать (tproger.ru)](https://tproger.ru/translations/ansible-how-to-use/)

[Installing Ansible — Ansible Documentation](https://docs.ansible.com/ansible/devel/installation_guide/intro_installation.html#installing-ansible-on-windows)

[Ansible — давайте попробуем / хендлеры и т.д.](https://habr.com/ru/company/express42/blog/254959/)

